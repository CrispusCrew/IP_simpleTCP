# cmake -DCMAKE_BUILD_TYPE=Release -G "Unix Makefiles" -B build
# cmake --build build --target client server
# cmake --install build

set(CMAKE_BUILD_TYPE Release)

project(simpleTCP)

cmake_minimum_required(VERSION 3.18)
cmake_policy(SET CMP0074 NEW)

set(CMAKE_CXX_STANDARD 11)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

set(SRC_DIR ${PROJECT_SOURCE_DIR}/src)
set(LIB_DIR ${PROJECT_SOURCE_DIR}/lib)
set(ASIO_INCLUDE_DIR ${PROJECT_SOURCE_DIR}/lib/asio)
set(LOG_DIR ${PROJECT_SOURCE_DIR}/log)

link_directories(${LIB_DIR})

file(MAKE_DIRECTORY ${LOG_DIR})

add_subdirectory(client)
add_subdirectory(server)

target_include_directories(server PUBLIC ${SRC_DIR} ${LIB_DIR} ${ASIO_INCLUDE_DIR})
target_include_directories(client PUBLIC ${SRC_DIR} ${LIB_DIR} ${ASIO_INCLUDE_DIR})

set(CMAKE_INSTALL_PREFIX ${PROJECT_SOURCE_DIR})
install(TARGETS client server RUNTIME DESTINATION bin)